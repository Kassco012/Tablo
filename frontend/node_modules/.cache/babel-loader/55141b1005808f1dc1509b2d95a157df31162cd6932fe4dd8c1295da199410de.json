{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kassymzhan.nuraliyev\\\\OneDrive - KAZ Minerals Management LLP\\\\Desktop\\\\Tablo_21_10\\\\Tablo\\\\frontend\\\\src\\\\components\\\\Dashboard.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useEquipment } from '../contexts/EquipmentContext';\nimport EquipmentTable from './EquipmentTable';\nimport { toast } from 'react-toastify';\nimport api from '../services/api';\nimport { getEquipmentTypeText } from '../components/EquipmentTypes';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst parseRussianDate = dateString => {\n  if (!dateString) return null;\n  try {\n    // Если уже в формате ISO - парсим как есть\n    if (dateString.includes('T') || dateString.includes('Z')) {\n      return new Date(dateString);\n    }\n\n    // Парсим русский формат: \"14.10.2025 21:54\"\n    const match = dateString.match(/(\\d{2})\\.(\\d{2})\\.(\\d{4})\\s+(\\d{2}):(\\d{2})/);\n    if (match) {\n      const [, day, month, year, hour, minute] = match;\n      return new Date(year, month - 1, day, hour, minute);\n    }\n\n    // Пытаемся парсить как есть\n    const date = new Date(dateString);\n    return isNaN(date.getTime()) ? null : date;\n  } catch (error) {\n    console.error('Error parsing date:', error);\n    return null;\n  }\n};\nconst calculateReadyToday = equipmentList => {\n  const now = new Date();\n  const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);\n  const todayEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59);\n  return equipmentList.filter(item => {\n    if (item.status !== 'Ready') return false;\n    const readyDate = parseRussianDate(item.date_time_ready);\n    if (!readyDate) return false;\n    return readyDate >= todayStart && readyDate <= todayEnd;\n  });\n};\nconst Dashboard = ({\n  onLoginClick\n}) => {\n  _s();\n  const queryClient = useQueryClient();\n  const {\n    user\n  } = useAuth();\n  const {\n    filters,\n    setFilters,\n    sortConfig,\n    setSortConfig,\n    savedComment,\n    setSavedComment\n  } = useEquipment();\n\n  // Локальные состояния UI - не трогаем при обновлении данных\n  const [editingItem, setEditingItem] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedComment, setSelectedComment] = useState(null);\n  const [localFilters, setLocalFilters] = useState(filters);\n\n  // Флаг для определения активности пользователя\n  const [isUserInteracting, setIsUserInteracting] = useState(false);\n\n  // Функция для получения данных\n  const fetchEquipmentData = async () => {\n    const response = await api.get('/equipment');\n    return response.data;\n  };\n\n  // React Query для получения данных с умным обновлением\n  const {\n    data: equipment = [],\n    isLoading,\n    isFetching,\n    isError,\n    error\n  } = useQuery({\n    queryKey: ['equipment'],\n    queryFn: fetchEquipmentData,\n    // Обновление каждые 30 секунд\n    refetchInterval: 30000,\n    // ВАЖНО: обновляем в фоне, не блокируя UI\n    refetchIntervalInBackground: true,\n    // Включаем обновление только если пользователь не взаимодействует\n    enabled: !isUserInteracting || !isModalOpen,\n    // Сохраняем предыдущие данные при обновлении\n    keepPreviousData: true,\n    // Умное сравнение данных - обновляем UI только при реальных изменениях\n    structuralSharing: (oldData, newData) => {\n      // Если модальное окно открыто, не обновляем данные\n      if (isModalOpen && editingItem) {\n        // Сохраняем редактируемый элемент\n        const updatedData = (newData === null || newData === void 0 ? void 0 : newData.map(item => item.id === editingItem.id ? editingItem : item)) || newData;\n        return updatedData;\n      }\n      return newData;\n    }\n  });\n\n  // Мутация для сохранения изменений\n  const updateEquipmentMutation = useMutation({\n    mutationFn: async updatedItem => {\n      const response = await api.put(`/equipment/${updatedItem.id}`, updatedItem);\n      return response.data;\n    },\n    onMutate: async updatedItem => {\n      // Отменяем текущие запросы\n      await queryClient.cancelQueries(['equipment']);\n\n      // Сохраняем предыдущие данные\n      const previousData = queryClient.getQueryData(['equipment']);\n\n      // Оптимистичное обновление\n      queryClient.setQueryData(['equipment'], old => {\n        if (!old) return [];\n        return old.map(item => item.id === updatedItem.id ? updatedItem : item);\n      });\n      return {\n        previousData\n      };\n    },\n    onError: (err, variables, context) => {\n      // При ошибке откатываем изменения\n      if (context !== null && context !== void 0 && context.previousData) {\n        queryClient.setQueryData(['equipment'], context.previousData);\n      }\n      toast.error('Ошибка при сохранении данных');\n    },\n    onSuccess: () => {\n      toast.success('Данные успешно сохранены');\n    },\n    onSettled: () => {\n      // После завершения делаем тихое обновление\n      setTimeout(() => {\n        queryClient.invalidateQueries(['equipment'], {\n          refetchType: 'background'\n        });\n      }, 1000);\n    }\n  });\n\n  // Обработчик редактирования\n  const handleEdit = item => {\n    setIsUserInteracting(true);\n    setEditingItem({\n      ...item\n    });\n    setIsModalOpen(true);\n  };\n\n  // Обработчик сохранения\n  const handleSave = async updatedItem => {\n    try {\n      await updateEquipmentMutation.mutateAsync(updatedItem);\n      setIsModalOpen(false);\n      setEditingItem(null);\n      setIsUserInteracting(false);\n    } catch (error) {\n      console.error('Error saving:', error);\n    }\n  };\n\n  // Обработчик закрытия модального окна\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n    setEditingItem(null);\n    setIsUserInteracting(false);\n    // Запускаем обновление после закрытия модалки\n    setTimeout(() => {\n      queryClient.invalidateQueries(['equipment']);\n    }, 500);\n  };\n\n  // Фильтрация и сортировка данных\n  const processedEquipment = useMemo(() => {\n    if (!equipment) return [];\n    let filtered = [...equipment];\n\n    // Применяем фильтры\n    if (localFilters.search) {\n      filtered = filtered.filter(item => Object.values(item).some(val => String(val).toLowerCase().includes(localFilters.search.toLowerCase())));\n    }\n    if (localFilters.status && localFilters.status !== 'all') {\n      filtered = filtered.filter(item => item.status === localFilters.status);\n    }\n    if (localFilters.type && localFilters.type !== 'all') {\n      filtered = filtered.filter(item => item.type === localFilters.type);\n    }\n\n    // Применяем сортировку\n    if (sortConfig.key) {\n      filtered.sort((a, b) => {\n        const aVal = a[sortConfig.key];\n        const bVal = b[sortConfig.key];\n        if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;\n        if (aVal > bVal) return sortConfig.direction === 'asc' ? 1 : -1;\n        return 0;\n      });\n    }\n    return filtered;\n  }, [equipment, localFilters, sortConfig]);\n\n  // Расчет статистики\n  const stats = useMemo(() => {\n    const readyToday = calculateReadyToday(equipment);\n    const readyCount = equipment.filter(e => e.status === 'Ready').length;\n    const repairCount = equipment.filter(e => e.status === 'Repair').length;\n    const notReadyCount = equipment.filter(e => e.status === 'NotReady').length;\n    return {\n      readyToday: readyToday.length,\n      ready: readyCount,\n      repair: repairCount,\n      notReady: notReadyCount,\n      total: equipment.length\n    };\n  }, [equipment]);\n\n  // Отслеживаем активность пользователя\n  useEffect(() => {\n    let timeout;\n    const handleActivity = () => {\n      setIsUserInteracting(true);\n      clearTimeout(timeout);\n      // Считаем пользователя неактивным через 5 секунд\n      timeout = setTimeout(() => {\n        if (!isModalOpen) {\n          setIsUserInteracting(false);\n        }\n      }, 5000);\n    };\n\n    // Слушаем события активности\n    window.addEventListener('mousemove', handleActivity);\n    window.addEventListener('keypress', handleActivity);\n    window.addEventListener('click', handleActivity);\n    return () => {\n      window.removeEventListener('mousemove', handleActivity);\n      window.removeEventListener('keypress', handleActivity);\n      window.removeEventListener('click', handleActivity);\n      clearTimeout(timeout);\n    };\n  }, [isModalOpen]);\n\n  // Синхронизация локальных фильтров с глобальными\n  useEffect(() => {\n    setLocalFilters(filters);\n  }, [filters]);\n\n  // Индикатор загрузки\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-spinner\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 13\n    }, this);\n  }\n\n  // Обработка ошибки\n  if (isError) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: (error === null || error === void 0 ? void 0 : error.message) || 'Произошла ошибка при загрузке'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => queryClient.invalidateQueries(['equipment']),\n        children: \"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u043D\\u043E\\u0432\\u0430\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard\",\n    children: [isFetching && !isLoading && !isUserInteracting && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sync-indicator\",\n      style: {\n        position: 'fixed',\n        top: '10px',\n        right: '10px',\n        background: 'rgba(79, 172, 254, 0.1)',\n        padding: '5px 10px',\n        borderRadius: '4px',\n        fontSize: '12px',\n        color: '#4facfe',\n        opacity: 0.6,\n        zIndex: 1000\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          marginRight: '5px'\n        },\n        children: \"\\u21BB\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 311,\n        columnNumber: 21\n      }, this), \"\\u0421\\u0438\\u043D\\u0445\\u0440\\u043E\\u043D\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F...\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stats-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E \\u0441\\u0435\\u0433\\u043E\\u0434\\u043D\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"stat-number\",\n          children: stats.readyToday\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"stat-number ready\",\n          children: stats.ready\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 322,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u0412 \\u0440\\u0435\\u043C\\u043E\\u043D\\u0442\\u0435\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"stat-number repair\",\n          children: stats.repair\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u041D\\u0435 \\u0433\\u043E\\u0442\\u043E\\u0432\\u043E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"stat-number not-ready\",\n          children: stats.notReady\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stat-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u0412\\u0441\\u0435\\u0433\\u043E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"stat-number\",\n          children: stats.total\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filters-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"\\u041F\\u043E\\u0438\\u0441\\u043A...\",\n        value: localFilters.search,\n        onChange: e => {\n          setLocalFilters({\n            ...localFilters,\n            search: e.target.value\n          });\n          setFilters({\n            ...filters,\n            search: e.target.value\n          });\n        },\n        className: \"search-input\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: localFilters.status,\n        onChange: e => {\n          setLocalFilters({\n            ...localFilters,\n            status: e.target.value\n          });\n          setFilters({\n            ...filters,\n            status: e.target.value\n          });\n        },\n        className: \"filter-select\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"all\",\n          children: \"\\u0412\\u0441\\u0435 \\u0441\\u0442\\u0430\\u0442\\u0443\\u0441\\u044B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"Ready\",\n          children: \"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"Repair\",\n          children: \"\\u0412 \\u0440\\u0435\\u043C\\u043E\\u043D\\u0442\\u0435\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"NotReady\",\n          children: \"\\u041D\\u0435 \\u0433\\u043E\\u0442\\u043E\\u0432\\u043E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: localFilters.type,\n        onChange: e => {\n          setLocalFilters({\n            ...localFilters,\n            type: e.target.value\n          });\n          setFilters({\n            ...filters,\n            type: e.target.value\n          });\n        },\n        className: \"filter-select\",\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"all\",\n          children: \"\\u0412\\u0441\\u0435 \\u0442\\u0438\\u043F\\u044B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"excavator\",\n          children: \"\\u042D\\u043A\\u0441\\u043A\\u0430\\u0432\\u0430\\u0442\\u043E\\u0440\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 376,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"bulldozer\",\n          children: \"\\u0411\\u0443\\u043B\\u044C\\u0434\\u043E\\u0437\\u0435\\u0440\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"loader\",\n          children: \"\\u041F\\u043E\\u0433\\u0440\\u0443\\u0437\\u0447\\u0438\\u043A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"dump_truck\",\n          children: \"\\u0421\\u0430\\u043C\\u043E\\u0441\\u0432\\u0430\\u043B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"grader\",\n          children: \"\\u0413\\u0440\\u0435\\u0439\\u0434\\u0435\\u0440\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(EquipmentTable, {\n      equipment: processedEquipment,\n      onEdit: handleEdit,\n      onSort: key => {\n        const direction = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';\n        setSortConfig({\n          key,\n          direction\n        });\n      },\n      sortConfig: sortConfig,\n      user: user,\n      onCommentClick: setSelectedComment\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 13\n    }, this), isModalOpen && editingItem && /*#__PURE__*/_jsxDEV(EditModal, {\n      item: editingItem,\n      onSave: handleSave,\n      onClose: handleCloseModal,\n      savedComment: savedComment,\n      setSavedComment: setSavedComment\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 17\n    }, this), selectedComment && /*#__PURE__*/_jsxDEV(CommentModal, {\n      comment: selectedComment,\n      onClose: () => setSelectedComment(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 17\n    }, this), !user && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"login-button\",\n      onClick: onLoginClick,\n      style: {\n        position: 'fixed',\n        bottom: '20px',\n        right: '20px',\n        padding: '10px 20px',\n        background: '#4facfe',\n        color: 'white',\n        border: 'none',\n        borderRadius: '8px',\n        cursor: 'pointer',\n        fontSize: '16px',\n        boxShadow: '0 2px 10px rgba(79, 172, 254, 0.3)'\n      },\n      children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 296,\n    columnNumber: 9\n  }, this);\n};\n\n// Компонент модального окна редактирования\n_s(Dashboard, \"nqYYGVQfAQsbNxhvzpCDgRtmkzQ=\", false, function () {\n  return [useQueryClient, useAuth, useEquipment, useQuery, useMutation];\n});\n_c = Dashboard;\nconst EditModal = ({\n  item,\n  onSave,\n  onClose,\n  savedComment,\n  setSavedComment\n}) => {\n  _s2();\n  // Локальное состояние формы - независимое от внешних обновлений\n  const [formData, setFormData] = useState(() => ({\n    ...item\n  }));\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Защита от внешних обновлений - обновляем только при смене записи\n  useEffect(() => {\n    if (item.id !== formData.id) {\n      setFormData({\n        ...item\n      });\n    }\n  }, [item.id]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setIsLoading(true);\n    try {\n      await onSave(formData);\n    } catch (error) {\n      console.error('Error saving:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleChange = (field, value) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal-overlay\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-content\",\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043E\\u0431\\u043E\\u0440\\u0443\\u0434\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            value: formData.name || '',\n            onChange: e => handleChange('name', e.target.value),\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: formData.status || 'NotReady',\n            onChange: e => handleChange('status', e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Ready\",\n              children: \"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"Repair\",\n              children: \"\\u0412 \\u0440\\u0435\\u043C\\u043E\\u043D\\u0442\\u0435\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"NotReady\",\n              children: \"\\u041D\\u0435 \\u0433\\u043E\\u0442\\u043E\\u0432\\u043E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u0422\\u0438\\u043F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 506,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: formData.type || '',\n            onChange: e => handleChange('type', e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"excavator\",\n              children: \"\\u042D\\u043A\\u0441\\u043A\\u0430\\u0432\\u0430\\u0442\\u043E\\u0440\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"bulldozer\",\n              children: \"\\u0411\\u0443\\u043B\\u044C\\u0434\\u043E\\u0437\\u0435\\u0440\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 512,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"loader\",\n              children: \"\\u041F\\u043E\\u0433\\u0440\\u0443\\u0437\\u0447\\u0438\\u043A\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"dump_truck\",\n              children: \"\\u0421\\u0430\\u043C\\u043E\\u0441\\u0432\\u0430\\u043B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"grader\",\n              children: \"\\u0413\\u0440\\u0435\\u0439\\u0434\\u0435\\u0440\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: formData.comment || '',\n            onChange: e => handleChange('comment', e.target.value),\n            rows: \"3\",\n            placeholder: \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 25\n          }, this), savedComment && savedComment.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"saved-comments\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"\\u0411\\u044B\\u0441\\u0442\\u0440\\u044B\\u0435 \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0438:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 531,\n              columnNumber: 33\n            }, this), savedComment.map((comment, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              className: \"comment-chip\",\n              onClick: () => handleChange('comment', comment),\n              children: comment\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 533,\n              columnNumber: 37\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: onClose,\n            className: \"btn-cancel\",\n            disabled: isLoading,\n            children: \"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 547,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn-save\",\n            disabled: isLoading,\n            children: isLoading ? 'Сохранение...' : 'Сохранить'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 555,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 478,\n    columnNumber: 9\n  }, this);\n};\n\n// Компонент модального окна комментария\n_s2(EditModal, \"gkMfC41kujp/YmnZ2+Wtlaytiag=\");\n_c2 = EditModal;\nconst CommentModal = ({\n  comment,\n  onClose\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"modal-overlay\",\n    onClick: onClose,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-content comment-modal\",\n      onClick: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: comment || 'Нет комментария'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        className: \"btn-close\",\n        children: \"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 573,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 572,\n    columnNumber: 9\n  }, this);\n};\n_c3 = CommentModal;\nexport default Dashboard;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"Dashboard\");\n$RefreshReg$(_c2, \"EditModal\");\n$RefreshReg$(_c3, \"CommentModal\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useQuery","useMutation","useQueryClient","useAuth","useEquipment","EquipmentTable","toast","api","getEquipmentTypeText","jsxDEV","_jsxDEV","parseRussianDate","dateString","includes","Date","match","day","month","year","hour","minute","date","isNaN","getTime","error","console","calculateReadyToday","equipmentList","now","todayStart","getFullYear","getMonth","getDate","todayEnd","filter","item","status","readyDate","date_time_ready","Dashboard","onLoginClick","_s","queryClient","user","filters","setFilters","sortConfig","setSortConfig","savedComment","setSavedComment","editingItem","setEditingItem","isModalOpen","setIsModalOpen","selectedComment","setSelectedComment","localFilters","setLocalFilters","isUserInteracting","setIsUserInteracting","fetchEquipmentData","response","get","data","equipment","isLoading","isFetching","isError","queryKey","queryFn","refetchInterval","refetchIntervalInBackground","enabled","keepPreviousData","structuralSharing","oldData","newData","updatedData","map","id","updateEquipmentMutation","mutationFn","updatedItem","put","onMutate","cancelQueries","previousData","getQueryData","setQueryData","old","onError","err","variables","context","onSuccess","success","onSettled","setTimeout","invalidateQueries","refetchType","handleEdit","handleSave","mutateAsync","handleCloseModal","processedEquipment","filtered","search","Object","values","some","val","String","toLowerCase","type","key","sort","a","b","aVal","bVal","direction","stats","readyToday","readyCount","e","length","repairCount","notReadyCount","ready","repair","notReady","total","timeout","handleActivity","clearTimeout","window","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","message","onClick","style","position","top","right","background","padding","borderRadius","fontSize","color","opacity","zIndex","marginRight","placeholder","value","onChange","target","onEdit","onSort","onCommentClick","EditModal","onSave","onClose","CommentModal","comment","bottom","border","cursor","boxShadow","_c","_s2","formData","setFormData","setIsLoading","handleSubmit","preventDefault","handleChange","field","prev","stopPropagation","onSubmit","name","required","rows","index","disabled","_c2","_c3","$RefreshReg$"],"sources":["C:/Users/kassymzhan.nuraliyev/OneDrive - KAZ Minerals Management LLP/Desktop/Tablo_21_10/Tablo/frontend/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useEquipment } from '../contexts/EquipmentContext';\r\nimport EquipmentTable from './EquipmentTable';\r\nimport { toast } from 'react-toastify';\r\nimport api from '../services/api';\r\n\r\nimport {\r\n    getEquipmentTypeText\r\n} from '../components/EquipmentTypes';\r\n\r\nconst parseRussianDate = (dateString) => {\r\n    if (!dateString) return null;\r\n\r\n    try {\r\n        // Если уже в формате ISO - парсим как есть\r\n        if (dateString.includes('T') || dateString.includes('Z')) {\r\n            return new Date(dateString);\r\n        }\r\n\r\n        // Парсим русский формат: \"14.10.2025 21:54\"\r\n        const match = dateString.match(/(\\d{2})\\.(\\d{2})\\.(\\d{4})\\s+(\\d{2}):(\\d{2})/);\r\n        if (match) {\r\n            const [, day, month, year, hour, minute] = match;\r\n            return new Date(year, month - 1, day, hour, minute);\r\n        }\r\n\r\n        // Пытаемся парсить как есть\r\n        const date = new Date(dateString);\r\n        return isNaN(date.getTime()) ? null : date;\r\n    } catch (error) {\r\n        console.error('Error parsing date:', error);\r\n        return null;\r\n    }\r\n};\r\n\r\nconst calculateReadyToday = (equipmentList) => {\r\n    const now = new Date();\r\n    const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);\r\n    const todayEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 23, 59, 59);\r\n\r\n    return equipmentList.filter(item => {\r\n        if (item.status !== 'Ready') return false;\r\n\r\n        const readyDate = parseRussianDate(item.date_time_ready);\r\n        if (!readyDate) return false;\r\n\r\n        return readyDate >= todayStart && readyDate <= todayEnd;\r\n    });\r\n};\r\n\r\nconst Dashboard = ({ onLoginClick }) => {\r\n    const queryClient = useQueryClient();\r\n    const { user } = useAuth();\r\n    const {\r\n        filters,\r\n        setFilters,\r\n        sortConfig,\r\n        setSortConfig,\r\n        savedComment,\r\n        setSavedComment\r\n    } = useEquipment();\r\n\r\n    // Локальные состояния UI - не трогаем при обновлении данных\r\n    const [editingItem, setEditingItem] = useState(null);\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [selectedComment, setSelectedComment] = useState(null);\r\n    const [localFilters, setLocalFilters] = useState(filters);\r\n\r\n    // Флаг для определения активности пользователя\r\n    const [isUserInteracting, setIsUserInteracting] = useState(false);\r\n\r\n    // Функция для получения данных\r\n    const fetchEquipmentData = async () => {\r\n        const response = await api.get('/equipment');\r\n        return response.data;\r\n    };\r\n\r\n    // React Query для получения данных с умным обновлением\r\n    const {\r\n        data: equipment = [],\r\n        isLoading,\r\n        isFetching,\r\n        isError,\r\n        error\r\n    } = useQuery({\r\n        queryKey: ['equipment'],\r\n        queryFn: fetchEquipmentData,\r\n        // Обновление каждые 30 секунд\r\n        refetchInterval: 30000,\r\n        // ВАЖНО: обновляем в фоне, не блокируя UI\r\n        refetchIntervalInBackground: true,\r\n        // Включаем обновление только если пользователь не взаимодействует\r\n        enabled: !isUserInteracting || !isModalOpen,\r\n        // Сохраняем предыдущие данные при обновлении\r\n        keepPreviousData: true,\r\n        // Умное сравнение данных - обновляем UI только при реальных изменениях\r\n        structuralSharing: (oldData, newData) => {\r\n            // Если модальное окно открыто, не обновляем данные\r\n            if (isModalOpen && editingItem) {\r\n                // Сохраняем редактируемый элемент\r\n                const updatedData = newData?.map(item =>\r\n                    item.id === editingItem.id ? editingItem : item\r\n                ) || newData;\r\n                return updatedData;\r\n            }\r\n            return newData;\r\n        }\r\n    });\r\n\r\n    // Мутация для сохранения изменений\r\n    const updateEquipmentMutation = useMutation({\r\n        mutationFn: async (updatedItem) => {\r\n            const response = await api.put(`/equipment/${updatedItem.id}`, updatedItem);\r\n            return response.data;\r\n        },\r\n        onMutate: async (updatedItem) => {\r\n            // Отменяем текущие запросы\r\n            await queryClient.cancelQueries(['equipment']);\r\n\r\n            // Сохраняем предыдущие данные\r\n            const previousData = queryClient.getQueryData(['equipment']);\r\n\r\n            // Оптимистичное обновление\r\n            queryClient.setQueryData(['equipment'], (old) => {\r\n                if (!old) return [];\r\n                return old.map(item =>\r\n                    item.id === updatedItem.id ? updatedItem : item\r\n                );\r\n            });\r\n\r\n            return { previousData };\r\n        },\r\n        onError: (err, variables, context) => {\r\n            // При ошибке откатываем изменения\r\n            if (context?.previousData) {\r\n                queryClient.setQueryData(['equipment'], context.previousData);\r\n            }\r\n            toast.error('Ошибка при сохранении данных');\r\n        },\r\n        onSuccess: () => {\r\n            toast.success('Данные успешно сохранены');\r\n        },\r\n        onSettled: () => {\r\n            // После завершения делаем тихое обновление\r\n            setTimeout(() => {\r\n                queryClient.invalidateQueries(['equipment'], {\r\n                    refetchType: 'background'\r\n                });\r\n            }, 1000);\r\n        }\r\n    });\r\n\r\n    // Обработчик редактирования\r\n    const handleEdit = (item) => {\r\n        setIsUserInteracting(true);\r\n        setEditingItem({ ...item });\r\n        setIsModalOpen(true);\r\n    };\r\n\r\n    // Обработчик сохранения\r\n    const handleSave = async (updatedItem) => {\r\n        try {\r\n            await updateEquipmentMutation.mutateAsync(updatedItem);\r\n            setIsModalOpen(false);\r\n            setEditingItem(null);\r\n            setIsUserInteracting(false);\r\n        } catch (error) {\r\n            console.error('Error saving:', error);\r\n        }\r\n    };\r\n\r\n    // Обработчик закрытия модального окна\r\n    const handleCloseModal = () => {\r\n        setIsModalOpen(false);\r\n        setEditingItem(null);\r\n        setIsUserInteracting(false);\r\n        // Запускаем обновление после закрытия модалки\r\n        setTimeout(() => {\r\n            queryClient.invalidateQueries(['equipment']);\r\n        }, 500);\r\n    };\r\n\r\n    // Фильтрация и сортировка данных\r\n    const processedEquipment = useMemo(() => {\r\n        if (!equipment) return [];\r\n\r\n        let filtered = [...equipment];\r\n\r\n        // Применяем фильтры\r\n        if (localFilters.search) {\r\n            filtered = filtered.filter(item =>\r\n                Object.values(item).some(val =>\r\n                    String(val).toLowerCase().includes(localFilters.search.toLowerCase())\r\n                )\r\n            );\r\n        }\r\n\r\n        if (localFilters.status && localFilters.status !== 'all') {\r\n            filtered = filtered.filter(item => item.status === localFilters.status);\r\n        }\r\n\r\n        if (localFilters.type && localFilters.type !== 'all') {\r\n            filtered = filtered.filter(item => item.type === localFilters.type);\r\n        }\r\n\r\n        // Применяем сортировку\r\n        if (sortConfig.key) {\r\n            filtered.sort((a, b) => {\r\n                const aVal = a[sortConfig.key];\r\n                const bVal = b[sortConfig.key];\r\n\r\n                if (aVal < bVal) return sortConfig.direction === 'asc' ? -1 : 1;\r\n                if (aVal > bVal) return sortConfig.direction === 'asc' ? 1 : -1;\r\n                return 0;\r\n            });\r\n        }\r\n\r\n        return filtered;\r\n    }, [equipment, localFilters, sortConfig]);\r\n\r\n    // Расчет статистики\r\n    const stats = useMemo(() => {\r\n        const readyToday = calculateReadyToday(equipment);\r\n        const readyCount = equipment.filter(e => e.status === 'Ready').length;\r\n        const repairCount = equipment.filter(e => e.status === 'Repair').length;\r\n        const notReadyCount = equipment.filter(e => e.status === 'NotReady').length;\r\n\r\n        return {\r\n            readyToday: readyToday.length,\r\n            ready: readyCount,\r\n            repair: repairCount,\r\n            notReady: notReadyCount,\r\n            total: equipment.length\r\n        };\r\n    }, [equipment]);\r\n\r\n    // Отслеживаем активность пользователя\r\n    useEffect(() => {\r\n        let timeout;\r\n\r\n        const handleActivity = () => {\r\n            setIsUserInteracting(true);\r\n            clearTimeout(timeout);\r\n            // Считаем пользователя неактивным через 5 секунд\r\n            timeout = setTimeout(() => {\r\n                if (!isModalOpen) {\r\n                    setIsUserInteracting(false);\r\n                }\r\n            }, 5000);\r\n        };\r\n\r\n        // Слушаем события активности\r\n        window.addEventListener('mousemove', handleActivity);\r\n        window.addEventListener('keypress', handleActivity);\r\n        window.addEventListener('click', handleActivity);\r\n\r\n        return () => {\r\n            window.removeEventListener('mousemove', handleActivity);\r\n            window.removeEventListener('keypress', handleActivity);\r\n            window.removeEventListener('click', handleActivity);\r\n            clearTimeout(timeout);\r\n        };\r\n    }, [isModalOpen]);\r\n\r\n    // Синхронизация локальных фильтров с глобальными\r\n    useEffect(() => {\r\n        setLocalFilters(filters);\r\n    }, [filters]);\r\n\r\n    // Индикатор загрузки\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"loading-container\">\r\n                <div className=\"loading-spinner\"></div>\r\n                <p>Загрузка данных...</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Обработка ошибки\r\n    if (isError) {\r\n        return (\r\n            <div className=\"error-container\">\r\n                <h2>Ошибка загрузки данных</h2>\r\n                <p>{error?.message || 'Произошла ошибка при загрузке'}</p>\r\n                <button onClick={() => queryClient.invalidateQueries(['equipment'])}>\r\n                    Попробовать снова\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"dashboard\">\r\n            {/* Индикатор фонового обновления - очень ненавязчивый */}\r\n            {isFetching && !isLoading && !isUserInteracting && (\r\n                <div className=\"sync-indicator\" style={{\r\n                    position: 'fixed',\r\n                    top: '10px',\r\n                    right: '10px',\r\n                    background: 'rgba(79, 172, 254, 0.1)',\r\n                    padding: '5px 10px',\r\n                    borderRadius: '4px',\r\n                    fontSize: '12px',\r\n                    color: '#4facfe',\r\n                    opacity: 0.6,\r\n                    zIndex: 1000\r\n                }}>\r\n                    <span style={{ marginRight: '5px' }}>↻</span>\r\n                    Синхронизация...\r\n                </div>\r\n            )}\r\n\r\n            {/* Статистика */}\r\n            <div className=\"stats-container\">\r\n                <div className=\"stat-card\">\r\n                    <h3>Готово сегодня</h3>\r\n                    <p className=\"stat-number\">{stats.readyToday}</p>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <h3>Готово</h3>\r\n                    <p className=\"stat-number ready\">{stats.ready}</p>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <h3>В ремонте</h3>\r\n                    <p className=\"stat-number repair\">{stats.repair}</p>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <h3>Не готово</h3>\r\n                    <p className=\"stat-number not-ready\">{stats.notReady}</p>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <h3>Всего</h3>\r\n                    <p className=\"stat-number\">{stats.total}</p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Фильтры */}\r\n            <div className=\"filters-container\">\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Поиск...\"\r\n                    value={localFilters.search}\r\n                    onChange={(e) => {\r\n                        setLocalFilters({ ...localFilters, search: e.target.value });\r\n                        setFilters({ ...filters, search: e.target.value });\r\n                    }}\r\n                    className=\"search-input\"\r\n                />\r\n\r\n                <select\r\n                    value={localFilters.status}\r\n                    onChange={(e) => {\r\n                        setLocalFilters({ ...localFilters, status: e.target.value });\r\n                        setFilters({ ...filters, status: e.target.value });\r\n                    }}\r\n                    className=\"filter-select\"\r\n                >\r\n                    <option value=\"all\">Все статусы</option>\r\n                    <option value=\"Ready\">Готово</option>\r\n                    <option value=\"Repair\">В ремонте</option>\r\n                    <option value=\"NotReady\">Не готово</option>\r\n                </select>\r\n\r\n                <select\r\n                    value={localFilters.type}\r\n                    onChange={(e) => {\r\n                        setLocalFilters({ ...localFilters, type: e.target.value });\r\n                        setFilters({ ...filters, type: e.target.value });\r\n                    }}\r\n                    className=\"filter-select\"\r\n                >\r\n                    <option value=\"all\">Все типы</option>\r\n                    <option value=\"excavator\">Экскаватор</option>\r\n                    <option value=\"bulldozer\">Бульдозер</option>\r\n                    <option value=\"loader\">Погрузчик</option>\r\n                    <option value=\"dump_truck\">Самосвал</option>\r\n                    <option value=\"grader\">Грейдер</option>\r\n                </select>\r\n            </div>\r\n\r\n            {/* Таблица оборудования */}\r\n            <EquipmentTable\r\n                equipment={processedEquipment}\r\n                onEdit={handleEdit}\r\n                onSort={(key) => {\r\n                    const direction = sortConfig.key === key && sortConfig.direction === 'asc'\r\n                        ? 'desc'\r\n                        : 'asc';\r\n                    setSortConfig({ key, direction });\r\n                }}\r\n                sortConfig={sortConfig}\r\n                user={user}\r\n                onCommentClick={setSelectedComment}\r\n            />\r\n\r\n            {/* Модальное окно редактирования */}\r\n            {isModalOpen && editingItem && (\r\n                <EditModal\r\n                    item={editingItem}\r\n                    onSave={handleSave}\r\n                    onClose={handleCloseModal}\r\n                    savedComment={savedComment}\r\n                    setSavedComment={setSavedComment}\r\n                />\r\n            )}\r\n\r\n            {/* Модальное окно комментария */}\r\n            {selectedComment && (\r\n                <CommentModal\r\n                    comment={selectedComment}\r\n                    onClose={() => setSelectedComment(null)}\r\n                />\r\n            )}\r\n\r\n            {/* Кнопка входа для неавторизованных */}\r\n            {!user && (\r\n                <button\r\n                    className=\"login-button\"\r\n                    onClick={onLoginClick}\r\n                    style={{\r\n                        position: 'fixed',\r\n                        bottom: '20px',\r\n                        right: '20px',\r\n                        padding: '10px 20px',\r\n                        background: '#4facfe',\r\n                        color: 'white',\r\n                        border: 'none',\r\n                        borderRadius: '8px',\r\n                        cursor: 'pointer',\r\n                        fontSize: '16px',\r\n                        boxShadow: '0 2px 10px rgba(79, 172, 254, 0.3)'\r\n                    }}\r\n                >\r\n                    Войти\r\n                </button>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\n// Компонент модального окна редактирования\r\nconst EditModal = ({ item, onSave, onClose, savedComment, setSavedComment }) => {\r\n    // Локальное состояние формы - независимое от внешних обновлений\r\n    const [formData, setFormData] = useState(() => ({ ...item }));\r\n    const [isLoading, setIsLoading] = useState(false);\r\n\r\n    // Защита от внешних обновлений - обновляем только при смене записи\r\n    useEffect(() => {\r\n        if (item.id !== formData.id) {\r\n            setFormData({ ...item });\r\n        }\r\n    }, [item.id]);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setIsLoading(true);\r\n\r\n        try {\r\n            await onSave(formData);\r\n        } catch (error) {\r\n            console.error('Error saving:', error);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleChange = (field, value) => {\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            [field]: value\r\n        }));\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n                <h2>Редактировать оборудование</h2>\r\n\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Название</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={formData.name || ''}\r\n                            onChange={(e) => handleChange('name', e.target.value)}\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Статус</label>\r\n                        <select\r\n                            value={formData.status || 'NotReady'}\r\n                            onChange={(e) => handleChange('status', e.target.value)}\r\n                        >\r\n                            <option value=\"Ready\">Готово</option>\r\n                            <option value=\"Repair\">В ремонте</option>\r\n                            <option value=\"NotReady\">Не готово</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Тип</label>\r\n                        <select\r\n                            value={formData.type || ''}\r\n                            onChange={(e) => handleChange('type', e.target.value)}\r\n                        >\r\n                            <option value=\"excavator\">Экскаватор</option>\r\n                            <option value=\"bulldozer\">Бульдозер</option>\r\n                            <option value=\"loader\">Погрузчик</option>\r\n                            <option value=\"dump_truck\">Самосвал</option>\r\n                            <option value=\"grader\">Грейдер</option>\r\n                        </select>\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label>Комментарий</label>\r\n                        <textarea\r\n                            value={formData.comment || ''}\r\n                            onChange={(e) => handleChange('comment', e.target.value)}\r\n                            rows=\"3\"\r\n                            placeholder=\"Добавьте комментарий...\"\r\n                        />\r\n\r\n                        {/* Сохраненные комментарии */}\r\n                        {savedComment && savedComment.length > 0 && (\r\n                            <div className=\"saved-comments\">\r\n                                <p>Быстрые комментарии:</p>\r\n                                {savedComment.map((comment, index) => (\r\n                                    <button\r\n                                        key={index}\r\n                                        type=\"button\"\r\n                                        className=\"comment-chip\"\r\n                                        onClick={() => handleChange('comment', comment)}\r\n                                    >\r\n                                        {comment}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"modal-actions\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"btn-cancel\"\r\n                            disabled={isLoading}\r\n                        >\r\n                            Отмена\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            className=\"btn-save\"\r\n                            disabled={isLoading}\r\n                        >\r\n                            {isLoading ? 'Сохранение...' : 'Сохранить'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Компонент модального окна комментария\r\nconst CommentModal = ({ comment, onClose }) => {\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal-content comment-modal\" onClick={(e) => e.stopPropagation()}>\r\n                <h3>Комментарий</h3>\r\n                <p>{comment || 'Нет комментария'}</p>\r\n                <button onClick={onClose} className=\"btn-close\">Закрыть</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}