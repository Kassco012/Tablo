{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kassymzhan.nuraliyev\\\\OneDrive - KAZ Minerals Management LLP\\\\Desktop\\\\Tablo\\\\Tablo\\\\frontend\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport api, { checkApiHealth } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ AuthProvider');\n  }\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [apiAvailable, setApiAvailable] = useState(false);\n  useEffect(() => {\n    initializeAuth();\n  }, []);\n  const initializeAuth = async () => {\n    try {\n      // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API\n      const isApiHealthy = await checkApiHealth();\n      setApiAvailable(isApiHealthy);\n      if (isApiHealthy) {\n        console.log('‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω');\n        await checkAuth();\n      } else {\n        console.error('‚ùå API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');\n      }\n    } catch (error) {\n      console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);\n      setApiAvailable(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const checkAuth = async () => {\n    try {\n      const token = localStorage.getItem('authToken');\n      if (!token) {\n        console.log('üîê –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω');\n        return;\n      }\n      console.log('üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞...');\n      const response = await api.get('/auth/verify');\n      setUser(response.data.user);\n      console.log('‚úÖ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', response.data.user);\n    } catch (error) {\n      console.error('‚ùå –¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω:', error);\n      localStorage.removeItem('authToken');\n      setUser(null);\n    }\n  };\n  const login = async (username, password) => {\n    try {\n      console.log('üîê –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', username);\n      const response = await api.post('/auth/login', {\n        username,\n        password\n      });\n      const {\n        token,\n        user: userData\n      } = response.data;\n      localStorage.setItem('authToken', token);\n      setUser(userData);\n      console.log('‚úÖ –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ API:', userData);\n      return userData;\n    } catch (error) {\n      console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);\n\n      // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫\n      if (error.network) {\n        throw {\n          message: '–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º'\n        };\n      } else if (error.status === 401) {\n        throw {\n          message: '–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'\n        };\n      } else {\n        throw {\n          message: error.message || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞'\n        };\n      }\n    }\n  };\n  const logout = () => {\n    console.log('üîê –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');\n    localStorage.removeItem('authToken');\n    setUser(null);\n  };\n  const register = async userData => {\n    try {\n      const response = await api.post('/auth/register', userData);\n      return response.data;\n    } catch (error) {\n      var _error$response;\n      throw ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || {\n        message: '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏'\n      };\n    }\n  };\n  const value = {\n    user,\n    loading,\n    apiAvailable,\n    login,\n    logout,\n    register,\n    checkAuth,\n    initializeAuth\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 9\n  }, this);\n};\n_s2(AuthProvider, \"Ebq/zndgaWiJi9s6kHnGPgFDfGw=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","checkApiHealth","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","AuthProvider","children","_s2","user","setUser","loading","setLoading","apiAvailable","setApiAvailable","initializeAuth","isApiHealthy","console","log","checkAuth","error","token","localStorage","getItem","response","get","data","removeItem","login","username","password","post","userData","setItem","network","message","status","logout","register","_error$response","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/kassymzhan.nuraliyev/OneDrive - KAZ Minerals Management LLP/Desktop/Tablo/Tablo/frontend/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport api, { checkApiHealth } from '../services/api';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const useAuth = () => {\r\n    const context = useContext(AuthContext);\r\n    if (!context) {\r\n        throw new Error('useAuth –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ AuthProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [apiAvailable, setApiAvailable] = useState(false);\r\n\r\n    useEffect(() => {\r\n        initializeAuth();\r\n    }, []);\r\n\r\n    const initializeAuth = async () => {\r\n        try {\r\n            // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API\r\n            const isApiHealthy = await checkApiHealth();\r\n            setApiAvailable(isApiHealthy);\r\n\r\n            if (isApiHealthy) {\r\n                console.log('‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω');\r\n                await checkAuth();\r\n            } else {\r\n                console.error('‚ùå API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');\r\n            }\r\n        } catch (error) {\r\n            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);\r\n            setApiAvailable(false);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const checkAuth = async () => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            if (!token) {\r\n                console.log('üîê –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω');\r\n                return;\r\n            }\r\n\r\n            console.log('üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞...');\r\n            const response = await api.get('/auth/verify');\r\n            setUser(response.data.user);\r\n            console.log('‚úÖ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', response.data.user);\r\n        } catch (error) {\r\n            console.error('‚ùå –¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω:', error);\r\n            localStorage.removeItem('authToken');\r\n            setUser(null);\r\n        }\r\n    };\r\n\r\n    const login = async (username, password) => {\r\n        try {\r\n            console.log('üîê –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', username);\r\n\r\n            const response = await api.post('/auth/login', {\r\n                username,\r\n                password\r\n            });\r\n\r\n            const { token, user: userData } = response.data;\r\n\r\n            localStorage.setItem('authToken', token);\r\n            setUser(userData);\r\n            console.log('‚úÖ –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ API:', userData);\r\n\r\n            return userData;\r\n        } catch (error) {\r\n            console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);\r\n\r\n            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫\r\n            if (error.network) {\r\n                throw { message: '–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º' };\r\n            } else if (error.status === 401) {\r\n                throw { message: '–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' };\r\n            } else {\r\n                throw { message: error.message || '–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞' };\r\n            }\r\n        }\r\n    };\r\n\r\n    const logout = () => {\r\n        console.log('üîê –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');\r\n        localStorage.removeItem('authToken');\r\n        setUser(null);\r\n    };\r\n\r\n    const register = async (userData) => {\r\n        try {\r\n            const response = await api.post('/auth/register', userData);\r\n            return response.data;\r\n        } catch (error) {\r\n            throw error.response?.data || { message: '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏' };\r\n        }\r\n    };\r\n\r\n    const value = {\r\n        user,\r\n        loading,\r\n        apiAvailable,\r\n        login,\r\n        logout,\r\n        register,\r\n        checkAuth,\r\n        initializeAuth\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={value}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}